infrastructures:
  bla: {}

nodes:
  mysql01.example.com: {}
  web01.example.com: {}
  web02.example.com: {}
  haproxy01.example.com: {}
  haproxy02.example.com: {}

configuration:
  nodes:
    mysql01.example.com:
      my_role: mysql
    web01.example.com:
      my_role: httpd
    web02.example.com:
      my_role: httpd
    haproxy01.example.com:
      my_role: haproxy

plan:
  max_in_flight: 1
  ssh_root_pass: 'vagrant'

steps:

  - name: 'test correct escaping of commands'
    nodes:
      - web01.example.com
    command:
      plugin: ssh/custom
      exec: 'echo'
      arguments: '"${MYVAR}" > /tmp/test'
      env:
        'MYVAR': 'MYVALUE'

