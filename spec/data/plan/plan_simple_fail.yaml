infrastructures:
  bla: {}

nodes:

  mysql01.example.com: {}
  web01.example.com: {}
  web02.example.com: {}
  haproxy01.example.com: {}
  haproxy02.example.com: {}

configuration:
  nodes:
    mysql01.example.com:
      my_role: mysql
    web01.example.com:
      my_role: httpd
    web02.example.com:
      my_role: httpd
    haproxy01.example.com:
      my_role: haproxy

plan:
  max_in_flight: 2
  ssh_root_pass: 'pass_from_plan'

steps:

  - name: simple_step_1
    nodes: all
    command:
      plugin: custom
      exec: 'echo'
      arguments:
        'Hello World':

  - name: simple_step_2
    nodes: all
    command:
      verify_commands:
        - plugin: custom
          exec: 'sh'
          arguments:
            '-c': "\"exit 1\""
        - plugin: custom
          exec: 'echo'
          arguments:
            'Hello World':
      plugin: custom
      exec: 'echo'
      arguments:
        'Hello Universe':

  - name: simple_step_3
    nodes: all
    command:
      verify_commands:
        - plugin: custom
          exec: 'sh'
          arguments:
            '-c': "\"exit 1\""
      plugin: custom
      exec: 'sh'
      arguments:
        '-c': "\"exit 1\""
